$(function(){function a(a,b){var c=new Tpl("data:<%=mime%>;base64,<%=base64%>").template(),d=c({mime:a,base64:b});return d}function b(a){var b=new Tpl($("#tpl-font-list").html()).template(),c=b({fonts:a,tabs:i});$("#font-list").html(c)}function c(a){chrome.tabs.query({active:!0,currentWindow:!0},function(b){var c=b[0];a&&a(c)})}function d(a){c(function(c){chrome.tabs.sendMessage(c.id,{action:"getProjectData"},function(c){c&&c.font&&(b(c.font),a&&a())})})}function e(a){var b=document.createElement("a");return b.href=a,"http:"!==b.protocol&&(b.protocol="http:"),b.href}function f(a,b){var c=new FileReader;c.onload=function(){var a=c.result,d=a.split(",")[1];b(d)},c.readAsDataURL(a)}function g(a,b){a=e(a),window.fetch(a,{method:"get",credentials:"include"}).then(function(a){return 200===a.status||0===a.status?Promise.resolve(a.blob()):Promise.reject(new Error(a.statusText))}).then(function(a){f(a,b)})["catch"](function(a){console.log(a)})}function h(){var b=$("#font-list");b.on("click",".datauri-btn",function(){var b=$(this),c=b.closest(".panel-body").find(".txa-uri");g(b.data("for"),function(d){c.val(a(j[b.data("ext")],d))})})}var i=[{tabId:"ttf",tabLabel:"TTF File",keyName:"ttf_file","default":!0},{tabId:"svg",tabLabel:"SVG File",keyName:"svg_file"},{tabId:"eot",tabLabel:"EOT File",keyName:"eot_file"},{tabId:"woff",tabLabel:"WOFF File",keyName:"woff_file"}],j={ttf:"application/x-font-ttf",svg:"image/svg+xml",eot:"application/vnd.ms-fontobject",woff:"application/font-woff"};chrome&&chrome.tabs&&d(function(){h()})});